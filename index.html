<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Código de Participação</title>
  <script>
    function gerarCodigo() {
      const letras = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
      const numeros = "0123456789";
      let codigo = "";
      for (let i = 0; i < 2; i++) codigo += letras[Math.floor(Math.random() * letras.length)];
      for (let i = 0; i < 4; i++) codigo += numeros[Math.floor(Math.random() * numeros.length)];
      document.getElementById("codigo").innerText = codigo;

      // Enviar para o Google Sheets
      fetch("https://script.google.com/macros/s/AKfycbxTPV1nsb5vOolJNxE2WStOBAGCp1zGJpICvv_FWAl2FMQPRQN1OTSYE8Ou6AGkByWN/exec", {
        method: "POST",
        body: JSON.stringify({ codigo: codigo }),
        headers: { "Content-Type": "application/json" },
        redirect: "follow" // Adicione esta linha
      }).then(response => {
        // Agora que o erro do Apps Script foi resolvido, você deve obter uma resposta 200 OK
        // Verifique se a resposta foi bem-sucedida (status 200-299)
        if (response.ok) {
            console.log("Código enviado com sucesso!");
            return response.json(); // Se a resposta for JSON
        } else {
            console.error("Erro na resposta do servidor:", response.status, response.statusText);
            return response.text().then(text => { throw new Error(text) }); // Para ver o corpo do erro
        }
      }).catch(error => {
        console.error("Erro ao enviar código:", error);
      });
    }

    window.onload = gerarCodigo;
  </script>
</head>
<body>
  <h2>Obrigado por responder!</h2>
  <p>Seu código de participação é: <strong id="codigo"></strong></p>
  <p>Guarde este código para participar do sorteio.</p>
</body>
</html>
